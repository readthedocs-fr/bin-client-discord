# This workflow will run tests on every push or pull request and lint using ESLint.

name: Continuous Integration

on:
    push:
        paths-ignore: ["*.{md,txt}", LICENSE, .*config, .vscode]
        tags-ignore: ["*"]
    pull_request:
        paths-ignore: ["*.{md,txt}", LICENSE, .*, '!.github/workflows']

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v2

            - name: Setup Node.js
              uses: actions/setup-node@v2
              with:
                  node-version: 15

            - name: Install dependencies
              run: yarn install --immutable

            - name: Build
              run: yarn build --noEmit

            - name: Lint with ESLint
              run: yarn lint

            - name: Run tests
              run: |
                  docker-compose -f rtdbin-docker-compose.yml up -d --build
                  yarn test
                  docker-compose -f rtdbin-docker-compose.yml down
